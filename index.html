<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SmartHome | Command Center</title>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    
    <style>
        :root { 
            --bg-color: #020617; --card-bg: #1e293b; --text-main: #f8fafc; 
            --text-sub: #94a3b8; --accent-blue: #38bdf8; --accent-red: #ef4444; 
            --accent-green: #22c55e; --accent-orange: #f97316; --glass: rgba(255, 255, 255, 0.03);
        }
        
        body { 
            font-family: 'Inter', 'Segoe UI', sans-serif; 
            background-color: var(--bg-color); 
            color: var(--text-main); 
            margin: 0; padding-bottom: 50px;
        }

        /* --- Header --- */
        .navbar { 
            background: rgba(15, 23, 42, 0.8); 
            backdrop-filter: blur(10px);
            padding: 20px; text-align: center; 
            position: sticky; top: 0; z-index: 100; 
            border-bottom: 1px solid rgba(255,255,255,0.1); 
        }
        .navbar h2 { margin: 0; letter-spacing: 2px; font-size: 1.2rem; color: var(--accent-blue); }
        .system-status { font-size: 0.8rem; color: var(--accent-green); margin-top: 5px; }

        /* --- Alert Banner System --- */
        .notification-area {
            width: 90%; max-width: 1200px; margin: 10px auto;
            display: flex; flex-direction: column; gap: 10px;
        }

        .alert-banner {
            padding: 15px; border-radius: 12px;
            display: none; text-align: center; font-weight: bold;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn { from { transform: translateY(-20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

        .bg-danger { background-color: var(--accent-red); color: white; }
        .bg-warning { background-color: var(--accent-orange); color: white; }

        /* --- Grid Layout --- */
        .dashboard-container { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); 
            gap: 20px; padding: 20px; width: 90%; max-width: 1200px; margin: 0 auto; 
        }

        .card { 
            background: var(--card-bg); 
            border-radius: 20px; padding: 25px; 
            border: 1px solid rgba(255, 255, 255, 0.05); 
            transition: all 0.3s ease;
            position: relative;
        }
        .card:hover { transform: translateY(-5px); border-color: var(--accent-blue); }
        .card.critical { border: 2px solid var(--accent-red); box-shadow: 0 0 15px rgba(239, 68, 68, 0.2); }

        .card h3 { 
            color: var(--text-sub); font-size: 0.8rem; 
            text-transform: uppercase; margin: 0 0 15px 0; letter-spacing: 1px;
        }

        .value-text { font-size: 2.8rem; font-weight: 800; margin: 10px 0; }
        .unit { font-size: 1.2rem; color: var(--text-sub); margin-left: 5px; }

        /* --- Status Pills --- */
        .status-pill { 
            padding: 6px 14px; border-radius: 8px; 
            font-size: 0.75rem; font-weight: 700; 
            text-transform: uppercase; display: inline-flex; align-items: center; gap: 5px;
        }
        .safe { background: rgba(34, 197, 94, 0.1); color: var(--accent-green); border: 1px solid var(--accent-green); }
        .danger { background: rgba(239, 68, 68, 0.2); color: var(--accent-red); border: 1px solid var(--accent-red); animation: pulse 1s infinite; }
        .active { background: rgba(56, 189, 248, 0.1); color: var(--accent-blue); border: 1px solid var(--accent-blue); }

        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.5; } 100% { opacity: 1; } }

        .mail-status {
            grid-column: 1 / -1; background: var(--glass);
            padding: 15px; border-radius: 12px; border: 1px dashed var(--text-sub);
            text-align: center; color: var(--text-sub); font-size: 0.9rem;
        }
    </style>
</head>
<body>

    <div class="navbar">
        <h2>HOME <span style="color:#fff">MONITORING</span> SYSTEM (v2.0)</h2>
        <div class="system-status">‚óè SYSTEM LIVE: CONNECTED TO FIREBASE</div>
    </div>

    <div class="notification-area">
        <div id="fire-alert" class="alert-banner bg-danger">
            ‚ö†Ô∏è EMERGENCY: FIRE DETECTED - ALERT EMAILS DISPATCHED
        </div>
        <div id="temp-alert" class="alert-banner bg-warning">
            üå°Ô∏è WARNING: CRITICAL TEMPERATURE DETECTED (>31¬∞C)
        </div>
    </div>

    <div class="dashboard-container">
        <div id="temp-card" class="card">
            <h3>Temperature</h3>
            <div class="value-text"><span id="temp">--</span><span class="unit">¬∞C</span></div>
            <div id="temp-ui" class="status-pill safe">Normal</div>
        </div>

        <div class="card">
            <h3>Humidity</h3>
            <div class="value-text"><span id="hum">--</span><span class="unit">%</span></div>
        </div>

        <div id="flame-card" class="card">
            <h3>Flame Sensor</h3>
            <div id="flame-val" class="value-text" style="font-size: 1.5rem;">WAITING...</div>
            <div id="flame-ui" class="status-pill safe">Scanning</div>
        </div>

        <div class="card">
            <h3>Gas Analyzer</h3>
            <div class="value-text" id="gas-val">--</div>
            <div id="gas-ui" class="status-pill safe">Level Normal</div>
        </div>

        <div class="card">
            <h3>Soil Moisture</h3>
            <div class="value-text" id="moist-val">--</div>
            <div id="pump-ui" class="status-pill safe">Pump Off</div>
        </div>

        <div class="card">
            <h3>Security</h3>
            <div id="vib-ui" class="status-pill safe">Structure Stable</div>
            <div class="value-text" id="ldr-status" style="font-size: 1.5rem; margin-top:15px;">--</div>
        </div>

        <div class="mail-status">
            Last Alert Status: <span id="mail-log" style="color: var(--accent-blue);">No recent alerts</span>
        </div>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyBzRrc530opID3Im-taMr9v3IIehz0xpw4",
            authDomain: "homemonitoringsystem.firebaseapp.com",
            databaseURL: "https://homemonitoringsystem-default-rtdb.firebaseio.com",
            projectId: "homemonitoringsystem",
            storageBucket: "homemonitoringsystem.firebasestorage.app",
            messagingSenderId: "680966579592",
            appId: "1:680966579592:web:f1e39af76ae50ca210c63d"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        const homeRef = db.ref('home');
        
        homeRef.on('value', (snapshot) => {
            const data = snapshot.val();
            if(!data) return;

            // 1. TEMPERATURE LOGIC
            const tempVal = parseFloat(data.temperature);
            document.getElementById("temp").innerText = tempVal;
            const tempCard = document.getElementById("temp-card");
            const tempUi = document.getElementById("temp-ui");
            const tempNotify = document.getElementById("temp-alert");

            if(tempVal > 31) {
                tempCard.classList.add("critical");
                tempUi.className = "status-pill danger";
                tempUi.innerText = "OVERHEAT";
                tempNotify.style.display = "block";
            } else {
                tempCard.classList.remove("critical");
                tempUi.className = "status-pill safe";
                tempUi.innerText = "Normal";
                tempNotify.style.display = "none";
            }

            // 2. FLAME LOGIC
            const flameUi = document.getElementById("flame-ui");
            const flameVal = document.getElementById("flame-val");
            const flameCard = document.getElementById("flame-card");
            const fireNotify = document.getElementById("fire-alert");

            if(data.flame === true) {
                flameVal.innerText = "üî• FIRE";
                flameCard.classList.add("critical");
                flameUi.className = "status-pill danger";
                flameUi.innerText = "CRITICAL";
                fireNotify.style.display = "block";
                document.getElementById("mail-log").innerText = "ALERT SENT: madetipavankumar9@gmail.com";
            } else {
                flameVal.innerText = "NONE";
                flameCard.classList.remove("critical");
                flameUi.className = "status-pill safe";
                flameUi.innerText = "Scanning";
                fireNotify.style.display = "none";
            }

            // 3. REMAINING DATA UPDATES
            document.getElementById("hum").innerText = data.humidity;
            document.getElementById("gas-val").innerText = data.gas;
            document.getElementById("moist-val").innerText = data.moisture;
            document.getElementById("ldr-status").innerText = "Mode: " + data.light;

            // Gas Alert UI
            const gasUi = document.getElementById("gas-ui");
            gasUi.className = (data.gas > 2500) ? "status-pill danger" : "status-pill safe";
            gasUi.innerText = (data.gas > 2500) ? "Gas Leak Detected" : "Level Normal";

            // Pump UI
            const pumpUi = document.getElementById("pump-ui");
            pumpUi.className = (data.pump === "ON") ? "status-pill active" : "status-pill safe";
            pumpUi.innerText = (data.pump === "ON") ? "Pump: Running" : "Pump: Idle";

            // Vibration UI
            const vibUi = document.getElementById("vib-ui");
            vibUi.className = (data.vibration === true) ? "status-pill danger" : "status-pill safe";
            vibUi.innerText = (data.vibration === true) ? "Vibration Alert" : "Structure Stable";
        });
    </script>
</body>
</html>